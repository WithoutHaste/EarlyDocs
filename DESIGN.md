[Home](README.md)

# Design

## Installation

Ideally, I wanted the EarlyDocs project to install such that its dependencies would not end up in the users's output directory, since they are needed for the build process only. But that hasn't worked out.

(1)

The MSBuild UsingTask element has two ways to specify an assembly - by assembly name or by exact file path.

Specifying by assembly name has not worked for me at all, even when the assembly is being referenced by the current project.

Specifying by exact path does work, but since this is a multi-targeted project it is hard to say what the exact path should be. This could be worked through except for the next problem.

(1b)

Either way you specify the assembly, dependencies of that assembly are searched for within the same folder as the starting dll. Even if those assemblies are referenced in the current project, they won't be found unless they are in that one folder.

So EarlyDocs.dll and all its dependencies must be in one folder. The simplest way to achieve this is letting everything end up in the output folder.

(2)

EarlyDocs and WithoutHaste.DataFiles are both multi-targeted because Reflection is very sensitive to the current target framework. So I have to let the project decide which version of each to use, based on the current target framework. The dlls that end up in the output directory are the ones selected by the project as compatible.

I verified that Nuspec files don't let you specify included files by target framework - you can only put these conditions on project dependencies. So you'll always be installing the dlls for every target framework even though you only need one of them.

## EarlyDocs Solution

### EarlyDocs Project

EarlyDocs is built on top the [WithoutHaste.DataFiles](https://github.com/WithoutHaste/WithoutHaste.DataFiles).

The DataFiles library is published as it's own NuGet package. _(pending)_

EarlyDocs depends on the WithoutHaste.DataFiles Nuget package.

### EarlyDocsTest Project

EarlyDocsTest is unit tests for just the EarlyDocs project - not for any functionality that could be tested within DataFiles. It's barely used. Most debugging at this level is done by looking at the generated Markdown files in the Test project.

### Test Project

The Test project depends on a local test build of the EarlyDocs NuGet package. It generates lots of Markdown files for testing various .Net coding constructs.

## AutomatedOracleTests Solutions

_(in progress)_  

Everything in the AutomatedOracleTests folder is auto-generated based on the Test project.

AutomatedOracleTests are separate Solutions (so their Packages remain separate) that depend on each possible target framework of the EarlyDocs NuGet package.

The AutomatedOracleTests are generated and built automatically, which causes them to generate their Markdown documentation files. These files are automatically compared to the /Test/oracleDocumenation files. Any discrepancies are reported as errors.

## InstallationTests

Steps to test:  
1) run Setup  
2) manually install NuGet EarlyDocs package to each project  
3) run Compare

### Setup

Creates copies of the EarlyDocs Test project, one for each target framework.

### AutoGenerated

Contains the copied Test projects.

NuGet installation must be run manually since the command line tool won't update the *.csproj files.

### Compare

Runs the test projects and compares their generated documentation to the oracle documentation.
